{% extends MainTpl %}

{% block header %}MyCrmTickets{% endblock %}

{% block header_block %}
{% include 'Header.html' %}
{% endblock %}

{% block main_content %}
<input type="hidden" name="install_url" id="install_url" value="{{install_url}}">

<input type="hidden" name="language" id="language" value="{{app_language}}">
<div class="ibox float-e-margins">
    <div class="ibox-title">
        <h5>{{module_words.title_index}}
            <!--<small>With custom checbox and radion elements.</small>-->
        </h5>

        <div class="ibox-tools">

            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                <i class="fa fa-gear"></i>
            </a>
            <ul class="dropdown-menu dropdown-user">
                <li><a href="{{install_url}}web/front.php/tickets/open_case">{{module_words.action_open_case}}</a></li>
            </ul>

        </div>
    </div>
    <div class="ibox-content">

        <div role="tabpanel">

            <!-- Nav tabs -->
            <ul class="nav nav-tabs" role="tablist">
                <li role="presentation" class="active"><a href="#groups" aria-controls="groups" role="tab"
                                                          data-toggle="tab">{{module_words.title_cases_open}}</a></li>
                <li role="presentation"><a href="#users" aria-controls="users" role="tab" data-toggle="tab">{{module_words.title_cases_closed}}</a>
                </li>
            </ul>

            <div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="groups">
                    <br/>
                    <!-- Cases list -->
                    <table id="tableCases" class="table table-striped table-bordered table-hover dataTables-example">
                        <thead>
                        <tr>
                            <th>Id</th>
                            <th>{{module_words.label_date}}</th>
                            <th>{{module_words.label_subject}}</th>
                            <th>{{module_words.label_type}}</th>
                            <th>{{module_words.label_status}}</th>
                            <th>{{module_words.label_priority}}</th>
                        </tr>
                        </thead>

                        <tfoot>
                        <tr>
                            <th>Id</th>
                            <th>{{module_words.label_date}}</th>
                            <th>{{module_words.label_subject}}</th>
                            <th>{{module_words.label_type}}</th>
                            <th>{{module_words.label_status}}</th>
                            <th>{{module_words.label_priority}}</th>
                        </tr>
                        </tfoot>

                        <tbody>



                        {% for case in cases %}
                        <tr onclick="window.location.href = '{{install_url}}web/front.php/tickets/view_case/{{ case.id }}';">

                            <td>{{ case.id}}</td>

                            <td>{{ case.case_date_open|date('d/m/Y') }}</td>
                            <td>{{ case.case_subject }}</td>

                            {% if case.case_type==1 %}
                            <td>{{ module_words.type_1}}</td>
                            {% elseif case.case_type==2 %}
                            <td>{{ module_words.type_2}}</td>
                            {% elseif case.case_type==3 %}
                            <td>{{ module_words.type_3}}</td>
                            {% endif %}

                            {% if case.case_status==1 %}
                            <td>{{ module_words.status_1}}</td>
                            {% elseif case.case_status==2 %}
                            <td>{{ module_words.status_2}}</td>
                            {% elseif case.case_status==3 %}
                            <td>{{ module_words.status_3}}</td>
                            {% elseif case.case_status==4 %}
                            <td>{{ module_words.status_4}}</td>
                            {% elseif case.case_status==5 %}
                            <td>{{ module_words.status_5}}</td>
                            {% elseif case.case_status==6 %}
                            <td>{{ module_words.status_6}}</td>
                            {% endif %}

                            {% if case.case_priority==1 %}
                            <td>{{ module_words.priority_1}}</td>
                            {% elseif case.case_priority==2 %}
                            <td>{{ module_words.priority_2}}</td>
                            {% elseif case.case_priority==3 %}
                            <td>{{ module_words.priority_3}}</td>
                            {% endif %}

                        </tr>
                        {% endfor %}

                        </tbody>
                    </table>
                </div>


                <div role="tabpanel" class="tab-pane" id="users">
                    <br/>
                    <!-- Cases list -->
                    <table id="tableCasesClosed"
                           class="table table-striped table-bordered table-hover dataTables-example">
                        <thead>
                        <tr>
                            <th>Id</th>
                            <th>{{module_words.label_date}}</th>
                            <th>{{module_words.label_subject}}</th>
                            <th>{{module_words.label_type}}</th>
                            <th>{{module_words.label_status}}</th>
                            <th>{{module_words.label_priority}}</th>
                        </tr>
                        </thead>

                        <tfoot>
                        <tr>
                            <th>Id</th>
                            <th>{{module_words.label_date}}</th>
                            <th>{{module_words.label_subject}}</th>
                            <th>{{module_words.label_type}}</th>
                            <th>{{module_words.label_status}}</th>
                            <th>{{module_words.label_priority}}</th>
                        </tr>
                        </tfoot>

                        <tbody>

                        {% for case in casesClosed %}
                        <tr onclick="window.location.href = '{{install_url}}web/front.php/cases/tickets/{{ case.id }}';">

                            <td>{{ case.id}}</td>
                            <td>{{ case.case_date_open|date('d/m/Y') }}</td>
                            <td>{{ case.case_subject }}</td>

                            {% if case.case_type==1 %}
                            <td>{{ module_words.type_1}}</td>
                            {% elseif case.case_type==2 %}
                            <td>{{ module_words.type_2}}</td>
                            {% elseif case.case_type==3 %}
                            <td>{{ module_words.type_3}}</td>
                            {% endif %}

                            {% if case.case_status==1 %}
                            <td>{{ module_words.status_1}}</td>
                            {% elseif case.case_status==2 %}
                            <td>{{ module_words.status_2}}</td>
                            {% elseif case.case_status==3 %}
                            <td>{{ module_words.status_3}}</td>
                            {% elseif case.case_status==4 %}
                            <td>{{ module_words.status_4}}</td>
                            {% elseif case.case_status==5 %}
                            <td>{{ module_words.status_5}}</td>
                            {% elseif case.case_status==6 %}
                            <td>{{ module_words.status_6}}</td>
                            {% endif %}

                            {% if case.case_priority==1 %}
                            <td>{{ module_words.priority_1}}</td>
                            {% elseif case.case_priority==2 %}
                            <td>{{ module_words.priority_2}}</td>
                            {% elseif case.case_priority==3 %}
                            <td>{{ module_words.priority_3}}</td>
                            {% endif %}

                        </tr>
                        {% endfor %}

                        </tbody>
                    </table>
                </div>
            </div>
        </div>


    </div>
</div>


<script src="{{install_url}}/src/MyCrm/Modules/{{module_name}}/Js/index.js"></script>
{% endblock %}
